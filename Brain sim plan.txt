Neural mass model that allows coupling of STN MERs in feedback loop.

define a class CNeuralStruc for each neural structure simulated.
Modules : initialise, delete, stepForward, initPara, Reset, readState, logAll

Uses a coupling matrix to connect all structures to each other.

main program reads all the states from the structers, sets up coupling matrix using values (including time delay), the state of each neural structure is then steped foward using the results from the coupling.

structures simulated in model:
D1,D2,STN,GPi/SNpr,GPe,TRN,Th and FC and FS(Fast Spiking striatal interneurons)

The model uses the Wilson & Cowan model for each structure, with single populations for each neural structure. Each structure is coupled via a synaptic current output controlled by the population rate, this is converted to an effective membrane potential that is passed through a sigmodal function to give the rate of change of the neural mass rate.

variables
mass rate v
averate pre-synaptic potential u
synaptic resistance R
synaptic current I
synaptic output J
sigmoidal function S
synaptic weighting G
time delay dt
synaptic time constant y
maximum firing rate e0
slope of response r
post synaptic potential coresponding to e0 u0

equations
vdot=-v+S[u]
u=RI±v (+/- excitatory/inhibitory)
I=sum(G J(t-dt))
y dJ/dt=-J+v

S(u) = [2 e0]/[1+e^r(u0-u)]

for the STN pp model
Ipp=Vpp/R
y dJ/dt=-Ipp